from typing import Protocol, runtime_checkable
from abc import abstractmethod
from nextcord.ext.abc.context_base import ContextBase
from ._types import T_co

@runtime_checkable
class Converter(Protocol[T_co]):
    """The base class of custom converters that require the :class:`.ContextBase`
    to be passed to be useful.

    This allows you to implement converters that function similar to the
    special cased ``discord`` classes.

    Classes that derive from this should override the :meth:`~.Converter.convert`
    method to do its conversion logic. This method must be a :ref:`coroutine <coroutine>`.
    """

    @abstractmethod
    async def convert(self, ctx: ContextBase, argument: str) -> T_co:
        """|coro|

        The method to override to do conversion logic.

        If an error is found while converting, it is recommended to
        raise a :exc:`.CommandError` derived exception as it will
        properly propagate to the error handlers.

        Parameters
        -----------
        ctx: :class:`.ContextBase`
            The invocation context that the argument is being used in.
        argument: :class:`str`
            The argument that is being converted.

        Raises
        -------
        :exc:`.CommandError`
            A generic exception occurred when converting the argument.
        :exc:`.BadArgument`
            The converter failed to convert the argument.
        """
        pass
